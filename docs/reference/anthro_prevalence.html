<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute prevalence estimates — anthro_prevalence • anthro</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute prevalence estimates — anthro_prevalence"><meta property="og:description" content="Prevalence estimates according to the WHO recommended standard analysis:
includes prevalence estimates with corresponding standard errors
and confidence intervals, and z-score summary statistics
(mean and standard deviation) with most common cut-offs describing the
full index distribution (-3, -2, -1, +1, +2, +3), and at disaggregated
levels for all available factors (age, sex, type of residence,
geographical regions, wealth quintiles, mother education and one
additional factor the user is interested in and for
which data are available)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">anthro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/WorldHealthOrganization/anthro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute prevalence estimates</h1>
    <small class="dont-index">Source: <a href="https://github.com/WorldHealthOrganization/anthro/blob/HEAD/R/prevalence.R" class="external-link"><code>R/prevalence.R</code></a></small>
    <div class="hidden name"><code>anthro_prevalence.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Prevalence estimates according to the WHO recommended standard analysis:
includes prevalence estimates with corresponding standard errors
and confidence intervals, and z-score summary statistics
(mean and standard deviation) with most common cut-offs describing the
full index distribution (-3, -2, -1, +1, +2, +3), and at disaggregated
levels for all available factors (age, sex, type of residence,
geographical regions, wealth quintiles, mother education and one
additional factor the user is interested in and for
which data are available).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anthro_prevalence</span><span class="op">(</span></span>
<span>  <span class="va">sex</span>,</span>
<span>  age <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  is_age_in_month <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  weight <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  lenhei <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  measure <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  oedema <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  sw <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  typeres <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  gregion <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  wealthq <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  mothered <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  othergr <span class="op">=</span> <span class="cn">NA_character_</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-sex">sex<a class="anchor" aria-label="anchor" href="#arg-sex"></a></dt>
<dd><p>A numeric or text variable containing gender information.
If it is numeric, its values must be: 1 for males and 2 for
females. If it is character, it must be "m" or "M" for males
and "f" or "F" for females. No z-scores will be calculated
if sex is missing.</p></dd>


<dt id="arg-age">age<a class="anchor" aria-label="anchor" href="#arg-age"></a></dt>
<dd><p>A numeric variable containing age information; age can be
in either days or months (if optional argument is_age_in_month
is set to TRUE). An exact age in days is expected and should
not be rounded if age is in months. Age-related z-scores will
NOT be calculated if age is missing (NA).</p></dd>


<dt id="arg-is-age-in-month">is_age_in_month<a class="anchor" aria-label="anchor" href="#arg-is-age-in-month"></a></dt>
<dd><p>A logical flag; if TRUE, variable age unit will be
treated as months. The function converts it to days by dividing
age by 30.4375 and rounding it to integer so that reference
tables can be used. When unspecified, the default value FALSE
is used and age unit is treated as days.</p></dd>


<dt id="arg-weight">weight<a class="anchor" aria-label="anchor" href="#arg-weight"></a></dt>
<dd><p>A numeric variable containing body weight information, which
must be in kilograms. Weight-related z-scores are not
calculated if body weight is missing.</p></dd>


<dt id="arg-lenhei">lenhei<a class="anchor" aria-label="anchor" href="#arg-lenhei"></a></dt>
<dd><p>A numeric variable containing length (recumbent length) or
height (standing height) information, which must be in
centimeters. Length/height-related z-scores will not be
calculated if lenhei is missing. For children with age
below 24 months (i.e. below 731 days) and standing height
measured, the function converts it to recumbent length by
adding 0.7 cm; and for children with age equal and above
24 months and measured in recumbent length, the function
converts it to standing height by subtracting 0.7 cm.
This way all the z-scores calculated by this function are
length-based for children below 24 months, and
height-based otherwise. This converted length/height
according to age is assigned to the variable clenhei in
the resulting data.frame.</p></dd>


<dt id="arg-measure">measure<a class="anchor" aria-label="anchor" href="#arg-measure"></a></dt>
<dd><p>A character variable indicating whether recumbent length
or standing height was measured for each observation.
The values of this variable must be "L" or "l" for recumbent
length, and "H" or "h" for standing height.
Although it is highly recommended that this variable
is provided according to the measurements taken in
the survey, it is possible to run the analysis without
specifying this variable. If unspecified, the default
vector with all missing values is used. The function
imputes the missing values according to the
following algorithm:</p><ul><li><p>If age is not missing, then it is recumbent length
      if age below 24 months (731 days), and standing height
      if age equal and above 24 months.</p></li>
<li><p>If age is missing, then it is recumbent length if
      measurement &lt; 87 cm and standing height
      if measurement &gt;= 87 cm.</p></li>
</ul></dd>


<dt id="arg-oedema">oedema<a class="anchor" aria-label="anchor" href="#arg-oedema"></a></dt>
<dd><p>The values of this character variable must be "n", "N" or "2"
for non-oedema, and "y", "Y", "1" for oedema. Although it is highly
recommended that this variable is provided by the survey,
it is possible to run
the analysis without specifying this variable. If unspecified,
the default vector of all "n" with values considered as
non-oedema is used. Missing values will be
treated as non-oedema. For oedema, weight related z-scores
(zwei, zwfl and zbmi) are NOT calculated (set to missing),
BUT they are treated as being &lt; -3 SD in the weight-related
indicator prevalence (<code>anthro_prevalence</code>)
estimation.</p></dd>


<dt id="arg-sw">sw<a class="anchor" aria-label="anchor" href="#arg-sw"></a></dt>
<dd><p>An optional numeric vector containing the sampling weights.
If NULL, no sampling weights are used.</p></dd>


<dt id="arg-cluster">cluster<a class="anchor" aria-label="anchor" href="#arg-cluster"></a></dt>
<dd><p>An optional integer vector representing clusters. If the value
is NULL this is treated as a survey without a cluster. This is also the case
if all values are equal, then we assume there is also no cluster.</p></dd>


<dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>An optional integer vector representing strata. Pass NULL to
indicate that there are no strata.</p></dd>


<dt id="arg-typeres">typeres<a class="anchor" aria-label="anchor" href="#arg-typeres"></a></dt>
<dd><p>An optional integer or character vector representing a type of
residence.
Any values are accepted, however, “Rural” or “Urban” are preferable
for outputs purposes.</p></dd>


<dt id="arg-gregion">gregion<a class="anchor" aria-label="anchor" href="#arg-gregion"></a></dt>
<dd><p>An optional integer or character vector representing a
geographical region.</p></dd>


<dt id="arg-wealthq">wealthq<a class="anchor" aria-label="anchor" href="#arg-wealthq"></a></dt>
<dd><p>An optional integer or character vector representing wealth
quintiles where (1=poorest; 2,3,4,5=richest).
All values can either be NA, or 1, 2, 3, 4, 5 or Q1, Q2, Q3, Q4, Q5.</p></dd>


<dt id="arg-mothered">mothered<a class="anchor" aria-label="anchor" href="#arg-mothered"></a></dt>
<dd><p>An optional integer or character vector representing the
education of the mother.
Any number of categories is accepted for the analysis, provided
sample sizes are sufficient in all categories. However, the common,
standard recommended categories are no education, primary school,
and secondary school or higher (“None”, “Primary” and “Secondary”).
Note: Mother education refers to the highest level of schooling
attained by the mother</p></dd>


<dt id="arg-othergr">othergr<a class="anchor" aria-label="anchor" href="#arg-othergr"></a></dt>
<dd><p>An optional integer or character vector that is of interest
for stratified analysis.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a data.frame with prevalence estimates for the various
groups.</p>
<p>The output data frame includes prevalence estimates with corresponding
standard errors and confidence intervals,
and z-score summary statistics (mean and standard deviation) with most
common cut-offs describing the full index
distribution (-3, -2, -1, +1, +2, +3), and at disaggregated levels for
all available factors (age, sex, type of residence,
geographical regions, wealth quintiles, mother education and one
additional factor the user is interested in and for which
data are available).</p>
<p>The resulting columns are coded with a <em>prefix</em>,
<em>a prevalence indicator</em> and <em>a suffix</em>:</p>
<p><strong>Prefix:</strong></p><dl><dt>HA</dt>
<dd><p>Height-for-age</p></dd>

 <dt>WA</dt>
<dd><p>Weight-for-age</p></dd>

 <dt>WA_2</dt>
<dd><p>Underweight</p></dd>

 <dt>BMI</dt>
<dd><p>Body-mass-index-for-age</p></dd>

 <dt>WH</dt>
<dd><p>Weight-for-height</p></dd>

 <dt>HA_WH</dt>
<dd><p>Height-for-age and weight-for-height combined</p></dd>


</dl><p><strong>Prevalence indicator:</strong></p><dl><dt>_3</dt>
<dd><p>Prevalence corresponding to &lt; -3 SD</p></dd>

 <dt>_2</dt>
<dd><p>Prevalence corresponding to &lt; -2 SD</p></dd>

 <dt>_1</dt>
<dd><p>Prevalence corresponding to &lt; -1 SD</p></dd>

 <dt>1</dt>
<dd><p>Prevalence corresponding to &gt; +1 SD</p></dd>

 <dt>2</dt>
<dd><p>Prevalence corresponding to &gt; +2 SD</p></dd>

 <dt>3</dt>
<dd><p>Prevalence corresponding to &gt; +3 SD</p></dd>


</dl><p><strong>Suffix:</strong></p><dl><dt>_pop</dt>
<dd><p>Weighted sample size</p></dd>

 <dt>_unwpop</dt>
<dd><p>Unweighted sample size</p></dd>

 <dt>_r</dt>
<dd><p>Mean/prevalence</p></dd>

 <dt>_ll</dt>
<dd><p>lower 95% confidence interval limit</p></dd>

 <dt>_ul</dt>
<dd><p>upper 95% confidence interval limit</p></dd>

 <dt>_stdev</dt>
<dd><p>Standard Deviation</p></dd>

 <dt>_se</dt>
<dd><p>Standard error</p></dd>


</dl><p><strong>For example:</strong></p><dl><dt>WHZ_pop</dt>
<dd><p>Weight-for-height weighted sample size</p></dd>

  <dt>HA_r</dt>
<dd><p>Height-for-age z-score mean</p></dd>

  <dt>WA_stdev</dt>
<dd><p>Weight-for-age z-score Standard Deviation</p></dd>

  <dt>WH2_r</dt>
<dd><p>Prevalence of weight-for-height &gt;+2 SD (overweight )</p></dd>

  <dt>WH_r</dt>
<dd><p>Mean weight-for-height z-score</p></dd>

  <dt>BMI_2_se</dt>
<dd><p>Prevalence of BMI-for-age &lt;-2 SD standard error</p></dd>

  <dt>BMI_3_ll</dt>
<dd><p>Prevalence of BMI-for-age &lt;-3 SD lower 95% confidence
  interval limit</p></dd>

  <dt>HA_2_WH_2_ul</dt>
<dd><p>Prevalence of children Height-for-age and
  weight-for-height combined (stunted &amp; wasted) lower 95% confidence
  interval limit</p></dd>


</dl><p><strong>Methods:</strong></p>
<p>The <code>survey</code> package is used to compute all estimates.
Confidence intervals are computed with a significance level of <code>0.05</code>.
<a href="https://rdrr.io/pkg/survey/man/surveysummary.html" class="external-link">svymean</a> is used the z-score mean and CIs, while for the
prevalence estimates <a href="https://rdrr.io/pkg/survey/man/svyciprop.html" class="external-link">svyciprop</a> is used with the <code>logit</code>
method.</p>
<p>For cases where <code>cluster/strata/sw is NULL</code> a fast approximation
is used that does not use the <code>survey</code> package but computes the same
results within bounds (maximum empirical difference is &lt; 0.0001).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>In this function, all available (non-missing and non-flagged) z-score values
are used for each indicator-specific prevalence
estimation (standard analysis).</p>
<p>Note: the function temporarily sets the <code>survey</code> option
<code>survey.lonely.psu</code> to "adjust" and then restores the original values.
The function is a wrapper around the <code>survey</code> package to compute
estimates for the different groups (e.g. by age or sex).</p>
<p>If not all parameter values have equal length, parameter values will be
repeated to match the maximum length of all arguments except
<code>is_age_in_month</code> using <code>rep_len</code>. This happens without warnings.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>T. Lumley (2024) "survey: analysis of complex survey samples".
R package version 4.4.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># because it takes too long for CRAN checks</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/WorldHealthOrganization/anthro" class="external-link">anthro</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute the prevalence estimates for 100 random children</span></span></span>
<span class="r-in"><span><span class="co"># with weight around 15kg and height around 100cm</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">anthro_prevalence</span><span class="op">(</span></span></span>
<span class="r-in"><span>  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># days</span></span></span>
<span class="r-in"><span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">15</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lenhei <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Height-for-age</span></span></span>
<span class="r-in"><span><span class="co"># We extract prevalence estimates for &lt;-3SD, &lt;-2SD (Stunting)</span></span></span>
<span class="r-in"><span><span class="co"># and the z-score mean</span></span></span>
<span class="r-in"><span><span class="va">col_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="st">"HAZ_unwpop"</span>, <span class="st">"HA_3_r"</span>, <span class="st">"HA_2_r"</span>, <span class="st">"HA_r"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>, <span class="va">col_names</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rename the columns</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="st">"Unweighted N"</span>, <span class="st">"-3SD"</span>, <span class="st">"-2SD"</span>, <span class="st">"z-score mean "</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># note that we only generated data for one age group</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dirk Schumacher, Elaine Borghi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

